## -*- mode: R -*-
##
## Copyright (C) 2022 Takeshi Abe
##
## This program is free software: you can redistribute it and/or modify
## it under the terms of the GNU General Public License as published by
## the Free Software Foundation, either version 3 of the License, or
## (at your option) any later version.
##
## This program is distributed in the hope that it will be useful,
## but WITHOUT ANY WARRANTY; without even the implied warranty of
## MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
## GNU General Public License for more details.
##
## You should have received a copy of the GNU General Public License
## along with this program.  If not, see <https://www.gnu.org/licenses/>.

#' Generate a crafted dataset of spurious importance
#'
#' Generate a crafted dataset as an example of important predictors with spuriously low importance.
#' There are five variables \eqn{v, w, x, y,} and \eqn{z} for predictors,
#' while two other variables \eqn{r} and \eqn{s} are for responses.
#' Every predictor variable, except \eqn{w}, is generated by following an independent
#' standard normal distribution.
#' On the other hand, \eqn{w} is defined by a simple linear equation of \eqn{v}:
#' \deqn{w = 1 - v.}
#' \eqn{r}'s true model is a multiple linear regression of the following equation:
#' \deqn{r = a v + b x + c y.}{r = a * v + b * x + c * y.}
#' By default all of the regression coefficients \eqn{a, b}, and \eqn{c} are positive;
#' \eqn{a} is the largest among them;
#' \eqn{c} is the smallest.
#' A binary variable \eqn{s} forms a factor with levels \dQuote{A} and \dQuote{B}.
#' It takes value "A" if \eqn{s} is of the lower ranks, \dQuote{B} otherwise.
#'
#' @param n the number of rows
#' @param a the regression coefficient of \eqn{v}
#' @param b the regression coefficient of \eqn{x}
#' @param c the regression coefficient of \eqn{y}
#'
#' @examples
#' ds <- generate_dataset(1000)
#'
#' @export
generate_dataset <- function(n = 500, a = 1, b = 0.2, c = 0.02) {
    v <- stats::rnorm(n)
    w <- 1-v
    x <- stats::rnorm(n)
    y <- stats::rnorm(n)
    z <- stats::rnorm(n)
    r <- a * v + b * x + c * y
    s <- factor(ifelse(r < stats::median(r), "A", "B"))
    data.frame(v, w, x, y, z, r, s)
}
